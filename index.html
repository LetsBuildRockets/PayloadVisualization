<html>
<head>
<script src="/socket.io/socket.io.js"></script>
<script src="processing.js"></script>
<style>
  .data {
    display: inline;
  }
  #sketch {
    float: left;
    margin-right: 20px;
  }
</style>
</head>

<body>
  <h1>Rocket IMU Visualization</h1>
  <canvas id='sketch' data-processing-sources="rocket.pde"></canvas>
  <div class="data">
    <table>
    <tr><td>Altitude:</td><td><input type="text" id="alt" disabled></td></tr>
    <tr><td>Temperature:</td><td><input type="text" id="temp" disabled></td></tr>
    <tr><td>Pitch:</td><td><input type="text" id="pitch" disabled></td></tr>
    <tr><td>Roll:</td><td><input type="text" id="roll" disabled></td></tr>
    <tr><td>Heading:</td><td><input type="text" id="heading" disabled></td></tr>
    <tr><td>X Acceleration:</td><td><input type="text" id="xLin" disabled></td></tr>
    <tr><td>Y Acceleration:</td><td><input type="text" id="yLin" disabled></td></tr>
    <tr><td>Z Acceleration:</td><td><input type="text" id="zLin" disabled></td></tr>
    </table>
  </div>
  
  
  
  
  
  <script>
    var processingInstance;

    function setAngles(x, y, z){
      if (!processingInstance) {
        processingInstance = Processing.getInstanceById('sketch');
      }
      processingInstance.setAngles(x, y, z);
    }

    /*setInterval(function() {
      setAngles(document.getElementById("x").value, document.getElementById("y").value, document.getElementById("z").value);
    },100);*/
  </script>
  <script>
    var socket = io();
    socket.on('data', function(data) {
      console.log(data)
      setAngles(data['pitch']+90,-data['roll'],data['heading']);
      document.getElementById("alt").value = data['alt'];
      document.getElementById("temp").value = data['temp'];
      document.getElementById("pitch").value = data['pitch'];
      document.getElementById("roll").value = data['roll'];
      document.getElementById("heading").value = data['heading'];
      document.getElementById("xLin").value = data['xLin'];
      document.getElementById("yLin").value = data['yLin'];
      document.getElementById("zLin").value = data['zLin'];
    });
</script>
</body>
</html>
